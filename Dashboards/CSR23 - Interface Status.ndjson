{"attributes":{"controlGroupInput":{"chainingSystem":"HIERARCHICAL","controlStyle":"oneLine","ignoreParentSettingsJSON":"{\"ignoreFilters\":false,\"ignoreQuery\":false,\"ignoreTimerange\":false,\"ignoreValidations\":false}","panelsJSON":"{}","showApplySelections":false},"description":"","kibanaSavedObjectMeta":{"searchSourceJSON":"{\"query\":{\"query\":\"\",\"language\":\"kuery\"}}"},"optionsJSON":"{\"hidePanelTitles\":false,\"useMargins\":true,\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false}","panelsJSON":"[{\"type\":\"lens\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"title\":\"CSR23 - Interface Status\",\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 30 minutes\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    packet_count = COUNT(*)\\r\\n  BY \\r\\n    Router = host.name, \\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Minutes_Ago = ROUND(DATE_DIFF(\\\"minutes\\\", last_seen, NOW()), 1),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"ðŸŸ¢ ACTIVE\\\",\\r\\n      Seconds_Ago < 90, \\\"ðŸŸ¡ WARNING\\\",\\r\\n      Seconds_Ago < 120, \\\"ðŸŸ  STALE\\\",\\r\\n      \\\"ðŸ”´ DOWN\\\"\\r\\n    ),\\r\\n    Age_Display = CASE(\\r\\n      Seconds_Ago < 60, CONCAT(TO_STRING(Seconds_Ago), \\\"s\\\"),\\r\\n      Seconds_Ago < 3600, CONCAT(TO_STRING(Minutes_Ago), \\\"m\\\"),\\r\\n      CONCAT(TO_STRING(ROUND(Minutes_Ago / 60.0, 1)), \\\"h\\\")\\r\\n    )\\r\\n| KEEP Router, Neighbor, Status, Age_Display, Seconds_Ago, last_seen, packet_count\\r\\n| SORT Seconds_Ago DESC\\r\\n\"},\"attributes\":{\"title\":\"Table Router & Neighbor & Status & Age_Display & Seconds_Ago\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"fce83c28-d8df-4265-b74f-fbfedd31de2e\":{\"index\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 30 minutes\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    packet_count = COUNT(*)\\r\\n  BY \\r\\n    Router = host.name, \\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Minutes_Ago = ROUND(DATE_DIFF(\\\"minutes\\\", last_seen, NOW()), 1),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"ðŸŸ¢ ACTIVE\\\",\\r\\n      Seconds_Ago < 90, \\\"ðŸŸ¡ WARNING\\\",\\r\\n      Seconds_Ago < 120, \\\"ðŸŸ  STALE\\\",\\r\\n      \\\"ðŸ”´ DOWN\\\"\\r\\n    ),\\r\\n    Age_Display = CASE(\\r\\n      Seconds_Ago < 60, CONCAT(TO_STRING(Seconds_Ago), \\\"s\\\"),\\r\\n      Seconds_Ago < 3600, CONCAT(TO_STRING(Minutes_Ago), \\\"m\\\"),\\r\\n      CONCAT(TO_STRING(ROUND(Minutes_Ago / 60.0, 1)), \\\"h\\\")\\r\\n    )\\r\\n| KEEP Router, Neighbor, Status, Age_Display, Seconds_Ago, last_seen, packet_count\\r\\n| SORT Seconds_Ago DESC\\r\\n\"},\"columns\":[{\"columnId\":\"Router\",\"fieldName\":\"Router\",\"label\":\"Router\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Neighbor\",\"fieldName\":\"Neighbor\",\"label\":\"Neighbor\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Status\",\"fieldName\":\"Status\",\"label\":\"Status\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Age_Display\",\"fieldName\":\"Age_Display\",\"label\":\"Age_Display\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Seconds_Ago\",\"fieldName\":\"Seconds_Ago\",\"label\":\"Seconds_Ago\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"integer\"},\"inMetricDimension\":true}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\"}]}},\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 30 minutes\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    packet_count = COUNT(*)\\r\\n  BY \\r\\n    Router = host.name, \\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Minutes_Ago = ROUND(DATE_DIFF(\\\"minutes\\\", last_seen, NOW()), 1),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"ðŸŸ¢ ACTIVE\\\",\\r\\n      Seconds_Ago < 90, \\\"ðŸŸ¡ WARNING\\\",\\r\\n      Seconds_Ago < 120, \\\"ðŸŸ  STALE\\\",\\r\\n      \\\"ðŸ”´ DOWN\\\"\\r\\n    ),\\r\\n    Age_Display = CASE(\\r\\n      Seconds_Ago < 60, CONCAT(TO_STRING(Seconds_Ago), \\\"s\\\"),\\r\\n      Seconds_Ago < 3600, CONCAT(TO_STRING(Minutes_Ago), \\\"m\\\"),\\r\\n      CONCAT(TO_STRING(ROUND(Minutes_Ago / 60.0, 1)), \\\"h\\\")\\r\\n    )\\r\\n| KEEP Router, Neighbor, Status, Age_Display, Seconds_Ago, last_seen, packet_count\\r\\n| SORT Seconds_Ago DESC\\r\\n\"},\"visualization\":{\"layerId\":\"fce83c28-d8df-4265-b74f-fbfedd31de2e\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"Router\"},{\"columnId\":\"Neighbor\"},{\"columnId\":\"Status\"},{\"columnId\":\"Age_Display\"},{\"columnId\":\"Seconds_Ago\"}]},\"adHocDataViews\":{\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\":{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"metrics-snmp.lldp-prod\",\"allowHidden\":false,\"managed\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\",\"version\":1}},\"panelIndex\":\"4a83c17e-cbc1-4173-84d8-c5fcc77aeb2b\",\"gridData\":{\"y\":0,\"x\":0,\"w\":48,\"h\":18,\"i\":\"4a83c17e-cbc1-4173-84d8-c5fcc77aeb2b\"}},{\"type\":\"lens\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"title\":\"Fault Detection (Missing Neighbors)\",\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 1 hour\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    samples = COUNT(*)\\r\\n  BY\\r\\n    Router = host.name,\\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Minutes_Ago = ROUND(DATE_DIFF(\\\"minutes\\\", last_seen, NOW()), 1),\\r\\n    Status = CASE(\\r\\n      DATE_DIFF(\\\"seconds\\\", last_seen, NOW()) < 60, \\\"OK ðŸŸ¢\\\",\\r\\n      DATE_DIFF(\\\"seconds\\\", last_seen, NOW()) < 90, \\\"WARNING ðŸŸ¡\\\",\\r\\n      DATE_DIFF(\\\"seconds\\\", last_seen, NOW()) < 120, \\\"ALERT ðŸŸ \\\",\\r\\n      \\\"CRITICAL ðŸ”´\\\"\\r\\n    )\\r\\n| WHERE Status != \\\"OK ðŸŸ¢\\\"\\r\\n| KEEP Router, Neighbor, Status, Minutes_Ago, samples, last_seen\\r\\n| SORT Minutes_Ago DESC\\r\\n\"},\"attributes\":{\"title\":\"Table Router & Neighbor & Status & Minutes_Ago & samples\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"f517cd8a-0495-435f-a58d-998cbcce55f2\":{\"index\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 1 hour\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    samples = COUNT(*)\\r\\n  BY\\r\\n    Router = host.name,\\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Minutes_Ago = ROUND(DATE_DIFF(\\\"minutes\\\", last_seen, NOW()), 1),\\r\\n    Status = CASE(\\r\\n      DATE_DIFF(\\\"seconds\\\", last_seen, NOW()) < 60, \\\"OK ðŸŸ¢\\\",\\r\\n      DATE_DIFF(\\\"seconds\\\", last_seen, NOW()) < 90, \\\"WARNING ðŸŸ¡\\\",\\r\\n      DATE_DIFF(\\\"seconds\\\", last_seen, NOW()) < 120, \\\"ALERT ðŸŸ \\\",\\r\\n      \\\"CRITICAL ðŸ”´\\\"\\r\\n    )\\r\\n| WHERE Status != \\\"OK ðŸŸ¢\\\"\\r\\n| KEEP Router, Neighbor, Status, Minutes_Ago, samples, last_seen\\r\\n| SORT Minutes_Ago DESC\\r\\n\"},\"columns\":[{\"columnId\":\"Router\",\"fieldName\":\"Router\",\"label\":\"Router\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Neighbor\",\"fieldName\":\"Neighbor\",\"label\":\"Neighbor\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Status\",\"fieldName\":\"Status\",\"label\":\"Status\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Minutes_Ago\",\"fieldName\":\"Minutes_Ago\",\"label\":\"Minutes_Ago\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"integer\"},\"inMetricDimension\":true},{\"columnId\":\"samples\",\"fieldName\":\"samples\",\"label\":\"samples\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"long\"},\"inMetricDimension\":true}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\"}]}},\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 1 hour\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    samples = COUNT(*)\\r\\n  BY\\r\\n    Router = host.name,\\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Minutes_Ago = ROUND(DATE_DIFF(\\\"minutes\\\", last_seen, NOW()), 1),\\r\\n    Status = CASE(\\r\\n      DATE_DIFF(\\\"seconds\\\", last_seen, NOW()) < 60, \\\"OK ðŸŸ¢\\\",\\r\\n      DATE_DIFF(\\\"seconds\\\", last_seen, NOW()) < 90, \\\"WARNING ðŸŸ¡\\\",\\r\\n      DATE_DIFF(\\\"seconds\\\", last_seen, NOW()) < 120, \\\"ALERT ðŸŸ \\\",\\r\\n      \\\"CRITICAL ðŸ”´\\\"\\r\\n    )\\r\\n| WHERE Status != \\\"OK ðŸŸ¢\\\"\\r\\n| KEEP Router, Neighbor, Status, Minutes_Ago, samples, last_seen\\r\\n| SORT Minutes_Ago DESC\\r\\n\"},\"visualization\":{\"layerId\":\"f517cd8a-0495-435f-a58d-998cbcce55f2\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"Router\"},{\"columnId\":\"Neighbor\"},{\"columnId\":\"Status\"},{\"columnId\":\"Minutes_Ago\"},{\"columnId\":\"samples\"}]},\"adHocDataViews\":{\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\":{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"metrics-snmp.lldp-prod\",\"allowHidden\":false,\"managed\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\",\"version\":1}},\"panelIndex\":\"c731d5db-70d2-4934-ac43-cb81b06bd444\",\"gridData\":{\"y\":18,\"x\":0,\"w\":24,\"h\":11,\"i\":\"c731d5db-70d2-4934-ac43-cb81b06bd444\"}},{\"type\":\"lens\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"title\":\"Interface Health Summary\",\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 1 hour\\r\\n| STATS\\r\\n    neighbors = COUNT_DISTINCT(network.lldp.rem.sysname),\\r\\n    last_update = MAX(@timestamp),\\r\\n    total_checks = COUNT(*)\\r\\n  BY\\r\\n    Router = host.name\\r\\n| EVAL\\r\\n    Minutes_Since = ROUND(DATE_DIFF(\\\"minutes\\\", last_update, NOW()), 1),\\r\\n    Health = CASE(\\r\\n      neighbors > 0 AND DATE_DIFF(\\\"seconds\\\", last_update, NOW()) < 300, \\\"Healthy ðŸŸ¢\\\",\\r\\n      neighbors > 0 AND DATE_DIFF(\\\"seconds\\\", last_update, NOW()) < 600, \\\"Degraded ðŸŸ¡\\\",\\r\\n      \\\"Critical ðŸ”´\\\"\\r\\n    )\\r\\n| KEEP Router, Health, neighbors, Minutes_Since, total_checks\\r\\n| SORT Router ASC\\r\\n\"},\"attributes\":{\"title\":\"Table neighbors & Router & Health\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"edbd6bf7-d494-4c42-b08b-0a55314b5ac4\":{\"index\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 1 hour\\r\\n| STATS\\r\\n    neighbors = COUNT_DISTINCT(network.lldp.rem.sysname),\\r\\n    last_update = MAX(@timestamp),\\r\\n    total_checks = COUNT(*)\\r\\n  BY\\r\\n    Router = host.name\\r\\n| EVAL\\r\\n    Minutes_Since = ROUND(DATE_DIFF(\\\"minutes\\\", last_update, NOW()), 1),\\r\\n    Health = CASE(\\r\\n      neighbors > 0 AND DATE_DIFF(\\\"seconds\\\", last_update, NOW()) < 300, \\\"Healthy ðŸŸ¢\\\",\\r\\n      neighbors > 0 AND DATE_DIFF(\\\"seconds\\\", last_update, NOW()) < 600, \\\"Degraded ðŸŸ¡\\\",\\r\\n      \\\"Critical ðŸ”´\\\"\\r\\n    )\\r\\n| KEEP Router, Health, neighbors, Minutes_Since, total_checks\\r\\n| SORT Router ASC\\r\\n\"},\"columns\":[{\"columnId\":\"neighbors\",\"fieldName\":\"neighbors\",\"label\":\"neighbors\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"long\"},\"inMetricDimension\":true},{\"columnId\":\"Router\",\"fieldName\":\"Router\",\"label\":\"Router\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Health\",\"fieldName\":\"Health\",\"label\":\"Health\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\"}]}},\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 1 hour\\r\\n| STATS\\r\\n    neighbors = COUNT_DISTINCT(network.lldp.rem.sysname),\\r\\n    last_update = MAX(@timestamp),\\r\\n    total_checks = COUNT(*)\\r\\n  BY\\r\\n    Router = host.name\\r\\n| EVAL\\r\\n    Minutes_Since = ROUND(DATE_DIFF(\\\"minutes\\\", last_update, NOW()), 1),\\r\\n    Health = CASE(\\r\\n      neighbors > 0 AND DATE_DIFF(\\\"seconds\\\", last_update, NOW()) < 300, \\\"Healthy ðŸŸ¢\\\",\\r\\n      neighbors > 0 AND DATE_DIFF(\\\"seconds\\\", last_update, NOW()) < 600, \\\"Degraded ðŸŸ¡\\\",\\r\\n      \\\"Critical ðŸ”´\\\"\\r\\n    )\\r\\n| KEEP Router, Health, neighbors, Minutes_Since, total_checks\\r\\n| SORT Router ASC\\r\\n\"},\"visualization\":{\"layerId\":\"edbd6bf7-d494-4c42-b08b-0a55314b5ac4\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"neighbors\"},{\"columnId\":\"Router\"},{\"columnId\":\"Health\"}]},\"adHocDataViews\":{\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\":{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"metrics-snmp.lldp-prod\",\"allowHidden\":false,\"managed\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\",\"version\":1}},\"panelIndex\":\"2c4695f2-64ca-4a77-9173-2c43da16f1e2\",\"gridData\":{\"y\":18,\"x\":24,\"w\":24,\"h\":11,\"i\":\"2c4695f2-64ca-4a77-9173-2c43da16f1e2\"}},{\"type\":\"lens\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"title\":\"Real-Time Interface Monitor\",\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 10 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| EVAL Interface = CASE(\\r\\n    network.lldp.rem.sysname == \\\"csr26\\\", \\\"eth1\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr28\\\", \\\"eth2\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr24\\\", \\\"eth3\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr25\\\", \\\"eth4\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr27\\\", \\\"eth5\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr29\\\", \\\"eth0\\\",\\r\\n    \\\"unknown\\\"\\r\\n  )\\r\\n| WHERE Interface != \\\"eth0\\\" AND Interface != \\\"unknown\\\"\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    packet_count = COUNT(*)\\r\\n  BY Interface, network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"LIVE ðŸŸ¢\\\",\\r\\n      Seconds_Ago < 120, \\\"RECENT ðŸŸ¡\\\",\\r\\n      Seconds_Ago < 300, \\\"STALE ðŸŸ \\\",\\r\\n      \\\"MISSING ðŸ”´\\\"\\r\\n    )\\r\\n| RENAME network.lldp.rem.sysname AS Neighbor\\r\\n| KEEP Interface, Neighbor, Status, Seconds_Ago, packet_count\\r\\n| SORT Interface ASC\\r\\n\"},\"attributes\":{\"title\":\"Table Interface & Neighbor & Status & Seconds_Ago & packet_count\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"6dc22a4f-5bbe-46f5-ad4e-d56719d7969c\":{\"index\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 10 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| EVAL Interface = CASE(\\r\\n    network.lldp.rem.sysname == \\\"csr26\\\", \\\"eth1\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr28\\\", \\\"eth2\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr24\\\", \\\"eth3\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr25\\\", \\\"eth4\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr27\\\", \\\"eth5\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr29\\\", \\\"eth0\\\",\\r\\n    \\\"unknown\\\"\\r\\n  )\\r\\n| WHERE Interface != \\\"eth0\\\" AND Interface != \\\"unknown\\\"\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    packet_count = COUNT(*)\\r\\n  BY Interface, network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"LIVE ðŸŸ¢\\\",\\r\\n      Seconds_Ago < 120, \\\"RECENT ðŸŸ¡\\\",\\r\\n      Seconds_Ago < 300, \\\"STALE ðŸŸ \\\",\\r\\n      \\\"MISSING ðŸ”´\\\"\\r\\n    )\\r\\n| RENAME network.lldp.rem.sysname AS Neighbor\\r\\n| KEEP Interface, Neighbor, Status, Seconds_Ago, packet_count\\r\\n| SORT Interface ASC\\r\\n\"},\"columns\":[{\"columnId\":\"Interface\",\"fieldName\":\"Interface\",\"label\":\"Interface\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Neighbor\",\"fieldName\":\"Neighbor\",\"label\":\"Neighbor\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Status\",\"fieldName\":\"Status\",\"label\":\"Status\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Seconds_Ago\",\"fieldName\":\"Seconds_Ago\",\"label\":\"Seconds_Ago\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"integer\"},\"inMetricDimension\":true},{\"columnId\":\"packet_count\",\"fieldName\":\"packet_count\",\"label\":\"packet_count\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"long\"},\"inMetricDimension\":true}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\"}]}},\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 10 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| EVAL Interface = CASE(\\r\\n    network.lldp.rem.sysname == \\\"csr26\\\", \\\"eth1\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr28\\\", \\\"eth2\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr24\\\", \\\"eth3\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr25\\\", \\\"eth4\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr27\\\", \\\"eth5\\\",\\r\\n    network.lldp.rem.sysname == \\\"csr29\\\", \\\"eth0\\\",\\r\\n    \\\"unknown\\\"\\r\\n  )\\r\\n| WHERE Interface != \\\"eth0\\\" AND Interface != \\\"unknown\\\"\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    packet_count = COUNT(*)\\r\\n  BY Interface, network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"LIVE ðŸŸ¢\\\",\\r\\n      Seconds_Ago < 120, \\\"RECENT ðŸŸ¡\\\",\\r\\n      Seconds_Ago < 300, \\\"STALE ðŸŸ \\\",\\r\\n      \\\"MISSING ðŸ”´\\\"\\r\\n    )\\r\\n| RENAME network.lldp.rem.sysname AS Neighbor\\r\\n| KEEP Interface, Neighbor, Status, Seconds_Ago, packet_count\\r\\n| SORT Interface ASC\\r\\n\"},\"visualization\":{\"layerId\":\"6dc22a4f-5bbe-46f5-ad4e-d56719d7969c\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"Interface\"},{\"columnId\":\"Neighbor\"},{\"columnId\":\"Status\"},{\"columnId\":\"Seconds_Ago\"},{\"columnId\":\"packet_count\"}]},\"adHocDataViews\":{\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\":{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"metrics-snmp.lldp-prod\",\"allowHidden\":false,\"managed\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\",\"version\":1}},\"panelIndex\":\"23c364bb-ec38-4bdc-bdc0-365aafed43cc\",\"gridData\":{\"y\":29,\"x\":0,\"w\":48,\"h\":14,\"i\":\"23c364bb-ec38-4bdc-bdc0-365aafed43cc\"}},{\"type\":\"lens\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE @timestamp > NOW() - 5 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    link_count = COUNT(*)\\r\\n  BY \\r\\n    Router = host.name, \\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"ðŸŸ¢ ACTIVE\\\",\\r\\n      Seconds_Ago < 90, \\\"ðŸŸ¡ WARNING\\\",\\r\\n      Seconds_Ago < 120, \\\"ðŸŸ  STALE\\\",\\r\\n      \\\"ðŸ”´ DOWN\\\"\\r\\n    ),\\r\\n    Age = CASE(\\r\\n      Seconds_Ago < 60, CONCAT(TO_STRING(Seconds_Ago), \\\"s\\\"),\\r\\n      CONCAT(TO_STRING(ROUND(Seconds_Ago / 60.0, 1)), \\\"m\\\")\\r\\n    )\\r\\n| KEEP Router, Neighbor, Status, Age, link_count\\r\\n| SORT Router ASC, Neighbor ASC\\r\\n\\r\\n\\r\\n\"},\"attributes\":{\"title\":\"Table Router & Neighbor & Status & Age & link_count\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"2ce40248-9191-41e7-aa49-a87f29f97cbd\":{\"index\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE @timestamp > NOW() - 5 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    link_count = COUNT(*)\\r\\n  BY \\r\\n    Router = host.name, \\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"ðŸŸ¢ ACTIVE\\\",\\r\\n      Seconds_Ago < 90, \\\"ðŸŸ¡ WARNING\\\",\\r\\n      Seconds_Ago < 120, \\\"ðŸŸ  STALE\\\",\\r\\n      \\\"ðŸ”´ DOWN\\\"\\r\\n    ),\\r\\n    Age = CASE(\\r\\n      Seconds_Ago < 60, CONCAT(TO_STRING(Seconds_Ago), \\\"s\\\"),\\r\\n      CONCAT(TO_STRING(ROUND(Seconds_Ago / 60.0, 1)), \\\"m\\\")\\r\\n    )\\r\\n| KEEP Router, Neighbor, Status, Age, link_count\\r\\n| SORT Router ASC, Neighbor ASC\\r\\n\\r\\n\\r\\n\"},\"columns\":[{\"columnId\":\"Router\",\"fieldName\":\"Router\",\"label\":\"Router\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Neighbor\",\"fieldName\":\"Neighbor\",\"label\":\"Neighbor\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Status\",\"fieldName\":\"Status\",\"label\":\"Status\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Age\",\"fieldName\":\"Age\",\"label\":\"Age\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"link_count\",\"fieldName\":\"link_count\",\"label\":\"link_count\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"long\"},\"inMetricDimension\":true}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\"}]}},\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE @timestamp > NOW() - 5 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    link_count = COUNT(*)\\r\\n  BY \\r\\n    Router = host.name, \\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"ðŸŸ¢ ACTIVE\\\",\\r\\n      Seconds_Ago < 90, \\\"ðŸŸ¡ WARNING\\\",\\r\\n      Seconds_Ago < 120, \\\"ðŸŸ  STALE\\\",\\r\\n      \\\"ðŸ”´ DOWN\\\"\\r\\n    ),\\r\\n    Age = CASE(\\r\\n      Seconds_Ago < 60, CONCAT(TO_STRING(Seconds_Ago), \\\"s\\\"),\\r\\n      CONCAT(TO_STRING(ROUND(Seconds_Ago / 60.0, 1)), \\\"m\\\")\\r\\n    )\\r\\n| KEEP Router, Neighbor, Status, Age, link_count\\r\\n| SORT Router ASC, Neighbor ASC\\r\\n\\r\\n\\r\\n\"},\"visualization\":{\"layerId\":\"2ce40248-9191-41e7-aa49-a87f29f97cbd\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"Router\"},{\"columnId\":\"Neighbor\"},{\"columnId\":\"Status\"},{\"columnId\":\"Age\"},{\"columnId\":\"link_count\"}]},\"adHocDataViews\":{\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\":{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"metrics-snmp.lldp-prod\",\"allowHidden\":false,\"managed\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\",\"version\":1}},\"panelIndex\":\"8771ed9f-d7a6-49e2-87b8-cc3b34f106f9\",\"gridData\":{\"y\":0,\"x\":0,\"w\":24,\"h\":15,\"i\":\"8771ed9f-d7a6-49e2-87b8-cc3b34f106f9\",\"sectionId\":\"c5d78583-a997-4f2e-8406-86f5182bfb80\"}},{\"type\":\"lens\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"title\":\"Summary Dashboard (Neighbor Count per Router\",\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE @timestamp > NOW() - 5 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| STATS\\r\\n    last_update = MAX(@timestamp),\\r\\n    neighbor_count = COUNT_DISTINCT(network.lldp.rem.sysname),\\r\\n    total_packets = COUNT(*)\\r\\n  BY Router = host.name\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_update, NOW()),\\r\\n    Health = CASE(\\r\\n      neighbor_count >= 4 AND Seconds_Ago < 60, \\\"âœ… HEALTHY\\\",\\r\\n      neighbor_count >= 3 AND Seconds_Ago < 90, \\\"âš ï¸ DEGRADED\\\",\\r\\n      \\\"âŒ CRITICAL\\\"\\r\\n    )\\r\\n| KEEP Router, Health, neighbor_count, Seconds_Ago, total_packets\\r\\n| SORT Router ASC\\r\\n\"},\"attributes\":{\"title\":\"neighbor_count & Seconds_Ago & total_packets of Health\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"deeba635-4d48-4268-9b76-b327bd303098\":{\"index\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE @timestamp > NOW() - 5 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| STATS\\r\\n    last_update = MAX(@timestamp),\\r\\n    neighbor_count = COUNT_DISTINCT(network.lldp.rem.sysname),\\r\\n    total_packets = COUNT(*)\\r\\n  BY Router = host.name\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_update, NOW()),\\r\\n    Health = CASE(\\r\\n      neighbor_count >= 4 AND Seconds_Ago < 60, \\\"âœ… HEALTHY\\\",\\r\\n      neighbor_count >= 3 AND Seconds_Ago < 90, \\\"âš ï¸ DEGRADED\\\",\\r\\n      \\\"âŒ CRITICAL\\\"\\r\\n    )\\r\\n| KEEP Router, Health, neighbor_count, Seconds_Ago, total_packets\\r\\n| SORT Router ASC\\r\\n\"},\"columns\":[{\"columnId\":\"Router\",\"fieldName\":\"Router\",\"label\":\"Router\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Health\",\"fieldName\":\"Health\",\"label\":\"Health\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"neighbor_count\",\"fieldName\":\"neighbor_count\",\"label\":\"neighbor_count\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"long\"},\"inMetricDimension\":true},{\"columnId\":\"Seconds_Ago\",\"fieldName\":\"Seconds_Ago\",\"label\":\"Seconds_Ago\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"integer\"},\"inMetricDimension\":true},{\"columnId\":\"total_packets\",\"fieldName\":\"total_packets\",\"label\":\"total_packets\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"long\"},\"inMetricDimension\":true}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\"}]}},\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE @timestamp > NOW() - 5 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| STATS\\r\\n    last_update = MAX(@timestamp),\\r\\n    neighbor_count = COUNT_DISTINCT(network.lldp.rem.sysname),\\r\\n    total_packets = COUNT(*)\\r\\n  BY Router = host.name\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_update, NOW()),\\r\\n    Health = CASE(\\r\\n      neighbor_count >= 4 AND Seconds_Ago < 60, \\\"âœ… HEALTHY\\\",\\r\\n      neighbor_count >= 3 AND Seconds_Ago < 90, \\\"âš ï¸ DEGRADED\\\",\\r\\n      \\\"âŒ CRITICAL\\\"\\r\\n    )\\r\\n| KEEP Router, Health, neighbor_count, Seconds_Ago, total_packets\\r\\n| SORT Router ASC\\r\\n\"},\"visualization\":{\"layerId\":\"deeba635-4d48-4268-9b76-b327bd303098\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"Router\"},{\"columnId\":\"Health\"},{\"columnId\":\"neighbor_count\"},{\"columnId\":\"Seconds_Ago\"},{\"columnId\":\"total_packets\"}]},\"adHocDataViews\":{\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\":{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"metrics-snmp.lldp-prod\",\"allowHidden\":false,\"managed\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\",\"version\":1}},\"panelIndex\":\"6bdc88a6-c6b1-4a5f-959d-66576a6d7b64\",\"gridData\":{\"y\":0,\"x\":24,\"w\":24,\"h\":15,\"i\":\"6bdc88a6-c6b1-4a5f-959d-66576a6d7b64\",\"sectionId\":\"c5d78583-a997-4f2e-8406-86f5182bfb80\"}},{\"type\":\"lens\",\"embeddableConfig\":{\"enhancements\":{\"dynamicActions\":{\"events\":[]}},\"title\":\"Network-Wide View (All Routers):\",\"syncColors\":false,\"syncCursor\":true,\"syncTooltips\":false,\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 30 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    packet_count = COUNT(*)\\r\\n  BY \\r\\n    Router = host.name, \\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Minutes_Ago = ROUND(DATE_DIFF(\\\"minutes\\\", last_seen, NOW()), 1),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"ðŸŸ¢ ACTIVE\\\",\\r\\n      Seconds_Ago < 90, \\\"ðŸŸ¡ WARNING\\\",\\r\\n      Seconds_Ago < 120, \\\"ðŸŸ  STALE\\\",\\r\\n      \\\"ðŸ”´ DOWN\\\"\\r\\n    ),\\r\\n    Age_Display = CASE(\\r\\n      Seconds_Ago < 60, CONCAT(TO_STRING(Seconds_Ago), \\\"s\\\"),\\r\\n      Seconds_Ago < 3600, CONCAT(TO_STRING(Minutes_Ago), \\\"m\\\"),\\r\\n      CONCAT(TO_STRING(ROUND(Minutes_Ago / 60.0, 1)), \\\"h\\\")\\r\\n    )\\r\\n| KEEP Router, Neighbor, Status, Age_Display, Seconds_Ago, last_seen, packet_count\\r\\n| SORT Neighbor ASC\\r\\n\"},\"attributes\":{\"title\":\"Table Router & Neighbor & Status & Age_Display & Seconds_Ago\",\"references\":[],\"state\":{\"datasourceStates\":{\"textBased\":{\"layers\":{\"7ecd0cae-bc23-47c3-a33d-5ae98155b91d\":{\"index\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 30 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    packet_count = COUNT(*)\\r\\n  BY \\r\\n    Router = host.name, \\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Minutes_Ago = ROUND(DATE_DIFF(\\\"minutes\\\", last_seen, NOW()), 1),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"ðŸŸ¢ ACTIVE\\\",\\r\\n      Seconds_Ago < 90, \\\"ðŸŸ¡ WARNING\\\",\\r\\n      Seconds_Ago < 120, \\\"ðŸŸ  STALE\\\",\\r\\n      \\\"ðŸ”´ DOWN\\\"\\r\\n    ),\\r\\n    Age_Display = CASE(\\r\\n      Seconds_Ago < 60, CONCAT(TO_STRING(Seconds_Ago), \\\"s\\\"),\\r\\n      Seconds_Ago < 3600, CONCAT(TO_STRING(Minutes_Ago), \\\"m\\\"),\\r\\n      CONCAT(TO_STRING(ROUND(Minutes_Ago / 60.0, 1)), \\\"h\\\")\\r\\n    )\\r\\n| KEEP Router, Neighbor, Status, Age_Display, Seconds_Ago, last_seen, packet_count\\r\\n| SORT Neighbor ASC\\r\\n\"},\"columns\":[{\"columnId\":\"Router\",\"fieldName\":\"Router\",\"label\":\"Router\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Neighbor\",\"fieldName\":\"Neighbor\",\"label\":\"Neighbor\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Status\",\"fieldName\":\"Status\",\"label\":\"Status\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Age_Display\",\"fieldName\":\"Age_Display\",\"label\":\"Age_Display\",\"customLabel\":false,\"meta\":{\"type\":\"string\",\"esType\":\"keyword\"},\"inMetricDimension\":true},{\"columnId\":\"Seconds_Ago\",\"fieldName\":\"Seconds_Ago\",\"label\":\"Seconds_Ago\",\"customLabel\":false,\"meta\":{\"type\":\"number\",\"esType\":\"integer\"},\"inMetricDimension\":true}],\"timeField\":\"@timestamp\"}},\"indexPatternRefs\":[{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\"}]}},\"filters\":[],\"query\":{\"esql\":\"From metrics-snmp.lldp-prod\\r\\n| WHERE host.name == \\\"csr23\\\"\\r\\n| WHERE @timestamp > NOW() - 30 minutes\\r\\n| WHERE network.lldp.rem.sysname IS NOT NULL\\r\\n| STATS\\r\\n    last_seen = MAX(@timestamp),\\r\\n    packet_count = COUNT(*)\\r\\n  BY \\r\\n    Router = host.name, \\r\\n    Neighbor = network.lldp.rem.sysname\\r\\n| EVAL\\r\\n    Seconds_Ago = DATE_DIFF(\\\"seconds\\\", last_seen, NOW()),\\r\\n    Minutes_Ago = ROUND(DATE_DIFF(\\\"minutes\\\", last_seen, NOW()), 1),\\r\\n    Status = CASE(\\r\\n      Seconds_Ago < 60, \\\"ðŸŸ¢ ACTIVE\\\",\\r\\n      Seconds_Ago < 90, \\\"ðŸŸ¡ WARNING\\\",\\r\\n      Seconds_Ago < 120, \\\"ðŸŸ  STALE\\\",\\r\\n      \\\"ðŸ”´ DOWN\\\"\\r\\n    ),\\r\\n    Age_Display = CASE(\\r\\n      Seconds_Ago < 60, CONCAT(TO_STRING(Seconds_Ago), \\\"s\\\"),\\r\\n      Seconds_Ago < 3600, CONCAT(TO_STRING(Minutes_Ago), \\\"m\\\"),\\r\\n      CONCAT(TO_STRING(ROUND(Minutes_Ago / 60.0, 1)), \\\"h\\\")\\r\\n    )\\r\\n| KEEP Router, Neighbor, Status, Age_Display, Seconds_Ago, last_seen, packet_count\\r\\n| SORT Neighbor ASC\\r\\n\"},\"visualization\":{\"layerId\":\"7ecd0cae-bc23-47c3-a33d-5ae98155b91d\",\"layerType\":\"data\",\"columns\":[{\"columnId\":\"Router\"},{\"columnId\":\"Neighbor\"},{\"columnId\":\"Status\"},{\"columnId\":\"Age_Display\"},{\"columnId\":\"Seconds_Ago\"}]},\"adHocDataViews\":{\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\":{\"id\":\"fd359f9d0c3d47d266c844fee3b899897d8bda76d3d134ee79f3788c46041166\",\"title\":\"metrics-snmp.lldp-prod\",\"sourceFilters\":[],\"type\":\"esql\",\"fieldFormats\":{},\"runtimeFieldMap\":{},\"allowNoIndex\":false,\"name\":\"metrics-snmp.lldp-prod\",\"allowHidden\":false,\"managed\":false}},\"needsRefresh\":false},\"visualizationType\":\"lnsDatatable\",\"version\":1}},\"panelIndex\":\"dcfb5d34-c36a-42f1-a288-79a37ba75d67\",\"gridData\":{\"y\":15,\"x\":0,\"w\":48,\"h\":16,\"i\":\"dcfb5d34-c36a-42f1-a288-79a37ba75d67\",\"sectionId\":\"c5d78583-a997-4f2e-8406-86f5182bfb80\"}}]","sections":[{"collapsed":false,"gridData":{"i":"c5d78583-a997-4f2e-8406-86f5182bfb80","y":43},"title":"Global View"}],"timeRestore":false,"title":"CSR23 - Interface Status"},"coreMigrationVersion":"8.8.0","created_at":"2025-11-27T04:02:13.297Z","created_by":"u_3556508399_cloud","id":"ad0dbb9f-d516-4d9f-b574-37ecc24fa7ea","managed":false,"references":[],"type":"dashboard","typeMigrationVersion":"10.3.0","updated_at":"2025-12-03T20:00:25.777Z","updated_by":"u_3556508399_cloud","version":"WzM2OCwxXQ=="}
{"excludedObjects":[],"excludedObjectsCount":0,"exportedCount":1,"missingRefCount":0,"missingReferences":[]}